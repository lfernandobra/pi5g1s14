package edu.gaed.dao;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.List;

import edu.gaed.modelo.Boletim;
import edu.gaed.modelo.Usuario;

public class BoletimDao extends BaseDao{
	public List<Boletim> obterBoletimTurma(int ID_Turma,int serie) {
		
		List<Boletim> boletim = new ArrayList<Boletim>();
		Connection conn = null;
		
		try {
			conn = this.getConnection();
			
			String sql = "select u.nome,t.Serie,t.Nome_Turma,d.nome_disciplina,b.bimestre,c.nota,c.faltas from"+
					"usuario u,turma t,disciplina d,boletim b,compoe c,aluno a ,estuda e,inserido i"+ 
					"where u.ID_Usuario = a.ID_Usuario and a.ID_Aluno = e.ID_Aluno and e.ID_Turma = t.ID_Turma and"+
					"b.ID_Boletim = c.ID_Boletim and c.ID_Disciplina = d.ID_Disciplina"+ 
					"and b.ID_Boletim = i.ID_Boletim and i.ID_Aluno = a.ID_Aluno and e.ID_Turma = ? and b.Bimestre = ?";
			PreparedStatement stmt = conn.prepareStatement(sql);
			
			ResultSet resultado = stmt.executeQuery();
			
			while (resultado.next()) {
				Usuario usuario = new Usuario();
				
				usuario.setId(resultado.getInt("ID_Usuario"));
				usuario.setLogin(resultado.getString("Login"));
				usuario.setNome(resultado.getString("Nome"));
				usuario.setSobrenome(resultado.getString("Sobrenome"));
				usuario.setSexo(resultado.getString("Sexo"));
				//usuario.setDatanasc(resultado.getDate("Data_Nascimento"));
								
				usuarios.add(usuario);
			}
		}
		catch (SQLException e) {
			e.printStackTrace();
		}
		finally {
			try {
				if (conn != null) {
					conn.close();
				}				
			}
			catch (Exception e) {
				//do nothing
			}
		}
		
		return usuarios;
	}
}
